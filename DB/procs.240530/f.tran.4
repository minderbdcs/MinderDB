COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;
 

CREATE OR ALTER PROCEDURE UPDATE_TRAN_V6 (RECORD_ID INTEGER,
COMPLETE CHAR(1) CHARACTER SET NONE,
ERROR_TEXT VARCHAR(255) CHARACTER SET NONE,
TRN_CLASS VARCHAR(10) CHARACTER SET NONE)
AS 
BEGIN
    /* Update transactions table */
    IF (COALESCE(TRN_CLASS,'') = '') THEN
    BEGIN
       UPDATE TRANSACTIONS
       SET COMPLETE = :COMPLETE, ERROR_TEXT = :ERROR_TEXT,
       MIRROR_DATA = TRN_DATE
       WHERE RECORD_ID = :RECORD_ID;
    END
    IF (TRN_CLASS = 'ADMIN') THEN
    BEGIN
       UPDATE TRANSACTIONS_ADMIN
       SET COMPLETE = :COMPLETE, ERROR_TEXT = :ERROR_TEXT,
       MIRROR_DATA = TRN_DATE
       WHERE RECORD_ID = :RECORD_ID;
    END
 
    SUSPEND;
END ^


SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
