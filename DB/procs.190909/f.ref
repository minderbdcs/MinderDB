COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;


ALTER PROCEDURE GET_REFERENCE_FIELD (REFERENCE TRN_DATA ,
FIELD_NO INTEGER)
RETURNS (WK_FIELD_TEXT TRN_DATA )
AS 
 
BEGIN
  
  IF (STRLEN(:REFERENCE) = 0) THEN
  BEGIN     
     EXIT;
  END
  
  WK_FIELD_TEXT = V6ALLTRIM(V6PARSE(REFERENCE, '|', FIELD_NO));
  IF (WK_FIELD_TEXT = 'Token to long in parse') THEN
  BEGIN
     WK_FIELD_TEXT = '';
  END
  SUSPEND;
END ^


SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
