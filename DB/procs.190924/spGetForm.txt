COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

CREATE OR ALTER PROCEDURE GET_FORM_NO  RETURNS (
  FORM_NO VARCHAR(8)
) AS  
DECLARE VARIABLE WK_FORMNO_I INTEGER;
DECLARE VARIABLE WK_LEN INTEGER;
DECLARE VARIABLE WK_FORMNO VARCHAR(8);
BEGIN
  WK_FORMNO_I = GEN_ID(FORM_NO_GEN, 1) ;
  
  /* default prefix */
  SELECT FORM_NO_PREFIX
    FROM CONTROL
    INTO :WK_FORMNO;

/*WK_LEN = STRLEN(WK_FORMNO_I) + STRLEN(WK_FORMNO); */
  WK_LEN = CHAR_LENGTH(WK_FORMNO_I) + CHAR_LENGTH(WK_FORMNO);

  /* Padding leading with 0 */
  WHILE (WK_LEN < 8) DO
  BEGIN
        WK_FORMNO = WK_FORMNO || '0';      
        WK_LEN = WK_LEN + 1;
  END
  WK_FORMNO = WK_FORMNO || WK_FORMNO_I;
  
  /* Return LoadNo to the caller */
  FORM_NO = WK_FORMNO;
  
END^


SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
