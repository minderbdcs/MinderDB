COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;
 
DROP   TRIGGER UPDATE_SSN_TIME ^
COMMIT^

CREATE TRIGGER UPDATE_SSN_TIME FOR SSN 
ACTIVE BEFORE UPDATE POSITION 20 
AS
BEGIN
   NEW.LAST_UPDATE_DATE = 'NOW';
   IF (NEW.CURRENT_QTY < 0) THEN
   BEGIN
      NEW.CURRENT_QTY = 0;
   END
   IF (NEW.DISPOSED = 'T' AND NEW.WH_ID <> 'XX') THEN
   BEGIN
      NEW.PREV_WH_ID = OLD.WH_ID;
      NEW.WH_ID = 'XX';
      NEW.STATUS_SSN = 'XX';
   END
END ^


SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
