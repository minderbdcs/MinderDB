
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_BUSINESS_MONTHLY_2_DATA 
(
  THISCOMPANY VARCHAR(20),
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  WH_ID1 VARCHAR(30),
  LOCN_ID1 VARCHAR(30),
  WH_ID2 VARCHAR(30),
  LOCN_ID2 VARCHAR(30),
  PROD_ID VARCHAR(30),
  DESCRIPTION VARCHAR(50),
  QTY INTEGER
)
AS
BEGIN
  /* PROCEDURE BODY */
  FOR
    SELECT SSN_HIST.WH_ID ,SSN_HIST.LOCN_ID ,
       SSN_HIST.TRN_TYPE, SSN_HIST.TRN_CODE, ISSN.PROD_ID,
       SSN_HIST.SSN_ID AS DESCRIPTION, ISSN.CURRENT_QTY AS QTY
    FROM SSN_HIST
    LEFT OUTER JOIN  SSN ON SSN_HIST.SSN_ID = SSN.SSN_ID
    LEFT OUTER JOIN  ISSN ON SSN_HIST.SSN_ID = ISSN.SSN_ID
    WHERE TRN_TYPE IN('TRLI', 'TRLO','TROL','TRIL')
    AND SSN_HIST.TRN_CODE IN ('A')
    AND SSN.COMPANY_ID = :THISCOMPANY
    AND  (TRN_DATE >= :THISSTART AND TRN_DATE <= :THISEND )

  INTO
:WH_ID1,
:LOCN_ID1,
:WH_ID2,
:LOCN_ID2,
:PROD_ID,
:DESCRIPTION,
:QTY
 
  DO
  BEGIN
  SUSPEND;
  END
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;


