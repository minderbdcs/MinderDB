
/*
    (PROD_PROFILE.COMPANY_ID = :THISCOMPANY OR
     PROD_PROFILE2.COMPANY_ID = :THISCOMPANY)
*/
    SELECT prod_profile.company_id, prod_profile2.company_id,
SSN_HIST.TRN_TYPE, 
       SSN_HIST.TRN_CODE,
       SSN_HIST.WH_ID ,
       SSN_HIST.LOCN_ID ,
       SSN_HIST.SSN_ID , 
       ISSN.CURRENT_QTY,
       ISSN.PROD_ID,
       PROD_PROFILE.SHORT_DESC,
       PROD_PROFILE2.SHORT_DESC,
       PROD_PROFILE.COMPANY_ID,
       PROD_PROFILE2.COMPANY_ID
    FROM SSN_HIST
    LEFT OUTER JOIN  ISSN ON SSN_HIST.SSN_ID = ISSN.SSN_ID
    LEFT OUTER JOIN  PROD_PROFILE ON PROD_PROFILE.PROD_ID = ISSN.PROD_ID
    LEFT OUTER JOIN  PROD_PROFILE  PROD_PROFILE2 ON PROD_PROFILE2.PROD_ID = SSN_HIST.SSN_ID
    WHERE SSN_HIST.TRN_TYPE IN ('TROL','TRLO','TRIL','TRLI') AND
    SSN_HIST.TRN_CODE IN ('A') AND 
    SSN_HIST.WH_ID='FH' AND
    (SSN_HIST.TRN_DATE BETWEEN cast('2001-01-01' as timestamp) AND 'TODAY') 
    ORDER BY ISSN.PROD_ID, SSN_HIST.SSN_ID, ISSN.ORIGINAL_SSN, SSN_HIST.TRN_DATE ;
