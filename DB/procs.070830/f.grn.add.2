COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;
 
ALTER PROCEDURE ADD_GRN (GRN VARCHAR(10) CHARACTER SET NONE,
GRN_TYPE CHAR(2) CHARACTER SET NONE,
TOTAL_QTY_PACKS INTEGER,
PACK_EAN_SSCC VARCHAR(18) CHARACTER SET NONE,
CARRIER VARCHAR(10) CHARACTER SET NONE,
VEHICLE_ID VARCHAR(8) CHARACTER SET NONE,
AWB_CONSIGNMENT_NO VARCHAR(20) CHARACTER SET NONE,
GRN_PALLET_QTY INTEGER,
DELIVERY_DOCKET VARCHAR(10) CHARACTER SET NONE,
PALLETS_YN CHAR(1) CHARACTER SET NONE,
CONTAINER_NO VARCHAR(20) CHARACTER SET NONE,
USER_ID VARCHAR(10) CHARACTER SET NONE,
DEVICE_ID CHAR(2) CHARACTER SET NONE,
GRN_DATE TIMESTAMP,
ORDER_NO VARCHAR(10) CHARACTER SET NONE,
ORDER_LINE_NO VARCHAR(4) CHARACTER SET NONE,
RETURN_ID VARCHAR(10) CHARACTER SET NONE,
COMMENTS VARCHAR(255) CHARACTER SET NONE,
SHIPPED_DATE TIMESTAMP)
RETURNS (GRN_ID VARCHAR(10) CHARACTER SET NONE)
AS 

  DECLARE VARIABLE REC_ID VARCHAR(10);
  
BEGIN  
  
     /* Add ISSN record */                                                                      
     /* REC_ID = CAST(GEN_ID(GRN, 1) AS VARCHAR(10)); */

     SELECT GRN 
     FROM NEXT_GRN_ID
     INTO :REC_ID ;

     GRN_ID = REC_ID;
    
     INSERT INTO GRN   
          (GRN, GRN_TYPE, TOTAL_QTY_PACKS, PACK_EAN_SSCC, CARRIER, VEHICLE_ID, AWB_CONSIGNMENT_NO,
           GRN_PALLET_QTY, DELIVERY_DOCKET, PALLETS_YN, CONTAINER_NO, USER_ID,
           DEVICE_ID, GRN_DATE, ORDER_NO, ORDER_LINE_NO, RETURN_ID, COMMENTS, SHIPPED_DATE, LAST_LINE_NO, LAST_PALLET_NO)
  
     VALUES (:REC_ID, :GRN_TYPE, :TOTAL_QTY_PACKS, :PACK_EAN_SSCC,:CARRIER, :VEHICLE_ID, :AWB_CONSIGNMENT_NO,
           :GRN_PALLET_QTY, :DELIVERY_DOCKET, :PALLETS_YN, :CONTAINER_NO, :USER_ID,
           :DEVICE_ID, 'NOW', :ORDER_NO, :ORDER_LINE_NO, :RETURN_ID, :COMMENTS, :SHIPPED_DATE,0,0);
              
END ^


SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
