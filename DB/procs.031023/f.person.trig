DROP TRIGGER INSERT_PERSON ^
COMMIT^

CREATE TRIGGER INSERT_PERSON FOR PERSON
ACTIVE AFTER  INSERT POSITION 10 
AS
DECLARE VARIABLE WK_PERSON VARCHAR(10);
DECLARE VARIABLE WK_STATUS CHAR(2);
DECLARE VARIABLE WK_TITLE VARCHAR(5);
DECLARE VARIABLE WK_FIRST_NAME VARCHAR(255);
DECLARE VARIABLE WK_LAST_NAME VARCHAR(30);
DECLARE VARIABLE WK_TYPE CHAR(2);
DECLARE VARIABLE WK_ADDRESS_LINE1 VARCHAR(50);
DECLARE VARIABLE WK_ADDRESS_LINE2 VARCHAR(50);
DECLARE VARIABLE WK_CITY VARCHAR(25);
DECLARE VARIABLE WK_STATE VARCHAR(15);
DECLARE VARIABLE WK_POSTCODE VARCHAR(10);
DECLARE VARIABLE WK_COUNTRY VARCHAR(25);
DECLARE VARIABLE WK_PHONE VARCHAR(30);
DECLARE VARIABLE WK_FAX VARCHAR(30);
DECLARE VARIABLE WK_MOBILE VARCHAR(15);
DECLARE VARIABLE WK_EMAIL VARCHAR(50);
DECLARE VARIABLE WK_MAIL_ADDRESS_LINE1 VARCHAR(50);
DECLARE VARIABLE WK_MAIL_ADDRESS_LINE2 VARCHAR(50);
DECLARE VARIABLE WK_MAIL_CITY VARCHAR(25);
DECLARE VARIABLE WK_MAIL_STATE VARCHAR(15);
DECLARE VARIABLE WK_MAIL_POSTCODE VARCHAR(10);
DECLARE VARIABLE WK_MAIL_COUNTRY VARCHAR(25);
DECLARE VARIABLE WK_MAIL_PHONE VARCHAR(30);
DECLARE VARIABLE WK_CONTACT_FIRST_NAME VARCHAR(25);
DECLARE VARIABLE WK_CONTACT_LAST_NAME VARCHAR(25);

DECLARE VARIABLE WK_CONTACT_ADDRESS_LINE1 VARCHAR(50);
DECLARE VARIABLE WK_CONTACT_ADDRESS_LINE2 VARCHAR(50);
DECLARE VARIABLE WK_CONTACT_CITY VARCHAR(25);
DECLARE VARIABLE WK_CONTACT_STATE VARCHAR(15);
DECLARE VARIABLE WK_CONTACT_POSTCODE VARCHAR(10);
DECLARE VARIABLE WK_CONTACT_COUNTRY VARCHAR(25);
DECLARE VARIABLE WK_CONTACT_PHONE VARCHAR(30);
DECLARE VARIABLE WK_2ND_CONTACT_FIRST_NAME VARCHAR(25);
DECLARE VARIABLE WK_2ND_CONTACT_LAST_NAME VARCHAR(25);
DECLARE VARIABLE WK_2ND_MOBILE VARCHAR(15);
DECLARE VARIABLE WK_2ND_EMAIL VARCHAR(50);
DECLARE VARIABLE WK_2ND_FAX VARCHAR(30);
DECLARE VARIABLE WK_2ND_PHONE VARCHAR(30);
DECLARE VARIABLE WK_CREATE_DATE TIMESTAMP;
DECLARE VARIABLE WK_CREATE_DATE_STR VARCHAR(30) ;
DECLARE VARIABLE WK_CREATE_BY VARCHAR(10);


DECLARE VARIABLE WK_DIRECTORY VARCHAR(80);
DECLARE VARIABLE WK_FILENAME VARCHAR(255);
DECLARE VARIABLE WK_LABEL_LINE VARCHAR(950);
/* currently 2234 */
DECLARE VARIABLE WK_RESULT INTEGER;
DECLARE VARIABLE WK_QUOTE CHAR(1);
BEGIN
   WK_QUOTE = chr(39);
   WK_PERSON = NEW.PERSON_ID;
   WK_STATUS = NEW.STATUS;
   WK_TITLE = NEW.TITLE;
   WK_FIRST_NAME = NEW.FIRST_NAME;
   WK_LAST_NAME = NEW.LAST_NAME;
   WK_TYPE = NEW.PERSON_TYPE;
   WK_ADDRESS_LINE1 = NEW.ADDRESS_LINE1;
   WK_ADDRESS_LINE2 = NEW.ADDRESS_LINE2;
   WK_CITY = NEW.CITY;
   WK_STATE = NEW.STATE;
   WK_POSTCODE = NEW.POST_CODE;
   WK_COUNTRY = NEW.COUNTRY;
   WK_PHONE = NEW.PHONE_NO;
   WK_FAX = NEW.FAX_NO;
   WK_MOBILE = NEW.MOBILE_NO;
   WK_EMAIL = NEW.EMAIL;
   WK_MAIL_ADDRESS_LINE1 = NEW.MAIL_ADDRESS1;
   WK_MAIL_ADDRESS_LINE2 = NEW.MAIL_ADDRESS2;
   WK_MAIL_CITY = NEW.MAIL_CITY;
   WK_MAIL_STATE = NEW.MAIL_STATE;
   WK_MAIL_POSTCODE = NEW.MAIL_POST_CODE;
   WK_MAIL_COUNTRY = NEW.MAIL_COUNTRY;
   WK_MAIL_PHONE = NEW.MAIL_PHONE;
   WK_CONTACT_FIRST_NAME = NEW.CONTACT_FIRST_NAME;
   WK_CONTACT_LAST_NAME = NEW.CONTACT_LAST_NAME;
   WK_CONTACT_ADDRESS_LINE1 = NEW.CONTACT_ADDRESS1;
   WK_CONTACT_ADDRESS_LINE2 = NEW.CONTACT_ADDRESS2;
   WK_CONTACT_CITY = NEW.CONTACT_CITY;
   WK_CONTACT_STATE = NEW.CONTACT_STATE;
   WK_CONTACT_POSTCODE = NEW.CONTACT_POST_CODE;
   WK_CONTACT_COUNTRY = NEW.CONTACT_COUNTRY;
   WK_CONTACT_PHONE = NEW.CONTACT_PHONE;
   WK_2ND_CONTACT_FIRST_NAME = NEW.SECOND_CONTACT_FIRST_NAME;
   WK_2ND_CONTACT_LAST_NAME = NEW.SECOND_CONTACT_LAST_NAME;
   WK_2ND_PHONE = NEW.SECOND_PHONE_NO;
   WK_2ND_MOBILE = NEW.SECOND_MOBILE_NO;
   WK_2ND_FAX = NEW.SECOND_FAX_NO;
   WK_2ND_EMAIL = NEW.SECOND_EMAIL;
   WK_CREATE_DATE = NEW.CREATE_DATE;
   WK_CREATE_DATE_STR = CAST(WK_CREATE_DATE AS CHAR(22));
   WK_CREATE_BY = NEW.CREATE_BY;

   SELECT EMPLOYEE_FTP_DIRECTORY FROM CONTROL INTO :WK_DIRECTORY;
   WK_FILENAME = WK_DIRECTORY || 'newperson.trn';
   WK_LABEL_LINE = WK_QUOTE || NONULL(WK_PERSON) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_STATUS) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_TITLE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_FIRST_NAME) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_LAST_NAME) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_TYPE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_ADDRESS_LINE1) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_ADDRESS_LINE2) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CITY) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_STATE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_POSTCODE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_COUNTRY) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_PHONE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_FAX) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MOBILE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_EMAIL) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_ADDRESS_LINE1) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_ADDRESS_LINE2) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_CITY) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_STATE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_POSTCODE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_COUNTRY) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_PHONE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_FIRST_NAME) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_LAST_NAME) || WK_QUOTE || ',' ;

   WK_RESULT = FILE_WRITE(WK_FILENAME, WK_LABEL_LINE);
   IF (WK_RESULT <> 0) THEN
   BEGIN
      WK_FILENAME = WK_DIRECTORY || 'newperson.2rn';
      WK_RESULT = FILE_WRITE(WK_FILENAME, WK_LABEL_LINE);
   END

   WK_LABEL_LINE = WK_QUOTE || NONULL(WK_CONTACT_ADDRESS_LINE1) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_ADDRESS_LINE2) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_CITY) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_STATE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_POSTCODE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_COUNTRY) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_PHONE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_2ND_CONTACT_FIRST_NAME) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_2ND_CONTACT_LAST_NAME) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_2ND_PHONE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_2ND_MOBILE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_2ND_FAX) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_2ND_EMAIL) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CREATE_DATE_STR) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CREATE_BY) || WK_QUOTE  ;

   WK_FILENAME = WK_DIRECTORY || 'newperson.trn';
   WK_RESULT = FILE_WRITE(WK_FILENAME, WK_LABEL_LINE);
   IF (WK_RESULT <> 0) THEN
   BEGIN
      WK_FILENAME = WK_DIRECTORY || 'newperson.2rn';
      WK_RESULT = FILE_WRITE(WK_FILENAME, WK_LABEL_LINE);
   END

END^

DROP TRIGGER UPDATE_PERSON ^
COMMIT^

CREATE TRIGGER UPDATE_PERSON FOR PERSON
ACTIVE AFTER  UPDATE POSITION 10 
AS
DECLARE VARIABLE WK_PERSON VARCHAR(10);
DECLARE VARIABLE WK_STATUS CHAR(2);
DECLARE VARIABLE WK_TITLE VARCHAR(5);
DECLARE VARIABLE WK_FIRST_NAME VARCHAR(255);
DECLARE VARIABLE WK_LAST_NAME VARCHAR(30);
DECLARE VARIABLE WK_TYPE CHAR(2);
DECLARE VARIABLE WK_ADDRESS_LINE1 VARCHAR(50);
DECLARE VARIABLE WK_ADDRESS_LINE2 VARCHAR(50);
DECLARE VARIABLE WK_CITY VARCHAR(25);
DECLARE VARIABLE WK_STATE VARCHAR(15);
DECLARE VARIABLE WK_POSTCODE VARCHAR(10);
DECLARE VARIABLE WK_COUNTRY VARCHAR(25);
DECLARE VARIABLE WK_PHONE VARCHAR(30);
DECLARE VARIABLE WK_FAX VARCHAR(30);
DECLARE VARIABLE WK_MOBILE VARCHAR(15);
DECLARE VARIABLE WK_EMAIL VARCHAR(50);
DECLARE VARIABLE WK_MAIL_ADDRESS_LINE1 VARCHAR(50);
DECLARE VARIABLE WK_MAIL_ADDRESS_LINE2 VARCHAR(50);
DECLARE VARIABLE WK_MAIL_CITY VARCHAR(25);
DECLARE VARIABLE WK_MAIL_STATE VARCHAR(15);
DECLARE VARIABLE WK_MAIL_POSTCODE VARCHAR(10);
DECLARE VARIABLE WK_MAIL_COUNTRY VARCHAR(25);
DECLARE VARIABLE WK_MAIL_PHONE VARCHAR(30);
DECLARE VARIABLE WK_CONTACT_FIRST_NAME VARCHAR(25);
DECLARE VARIABLE WK_CONTACT_LAST_NAME VARCHAR(25);
DECLARE VARIABLE WK_CONTACT_ADDRESS_LINE1 VARCHAR(50);
DECLARE VARIABLE WK_CONTACT_ADDRESS_LINE2 VARCHAR(50);
DECLARE VARIABLE WK_CONTACT_CITY VARCHAR(25);
DECLARE VARIABLE WK_CONTACT_STATE VARCHAR(15);
DECLARE VARIABLE WK_CONTACT_POSTCODE VARCHAR(10);
DECLARE VARIABLE WK_CONTACT_COUNTRY VARCHAR(25);
DECLARE VARIABLE WK_CONTACT_PHONE VARCHAR(30);
DECLARE VARIABLE WK_2ND_CONTACT_FIRST_NAME VARCHAR(25);
DECLARE VARIABLE WK_2ND_CONTACT_LAST_NAME VARCHAR(25);
DECLARE VARIABLE WK_2ND_MOBILE VARCHAR(15);
DECLARE VARIABLE WK_2ND_EMAIL VARCHAR(50);
DECLARE VARIABLE WK_2ND_FAX VARCHAR(30);
DECLARE VARIABLE WK_2ND_PHONE VARCHAR(30);
DECLARE VARIABLE WK_CREATE_DATE TIMESTAMP;
DECLARE VARIABLE WK_CREATE_DATE_STR VARCHAR(30) ;
DECLARE VARIABLE WK_CREATE_BY VARCHAR(10);

DECLARE VARIABLE WK_DIRECTORY VARCHAR(80);
DECLARE VARIABLE WK_FILENAME VARCHAR(255);
DECLARE VARIABLE WK_LABEL_LINE VARCHAR(1024);
DECLARE VARIABLE WK_RESULT INTEGER;
DECLARE VARIABLE WK_QUOTE CHAR(1);

BEGIN
   WK_QUOTE = chr(39);
   WK_PERSON = NEW.PERSON_ID;
   WK_STATUS = NEW.STATUS;
   WK_TITLE = NEW.TITLE;
   WK_FIRST_NAME = NEW.FIRST_NAME;
   WK_LAST_NAME = NEW.LAST_NAME;
   WK_TYPE = NEW.PERSON_TYPE;
   WK_ADDRESS_LINE1 = NEW.ADDRESS_LINE1;
   WK_ADDRESS_LINE2 = NEW.ADDRESS_LINE2;
   WK_CITY = NEW.CITY;
   WK_STATE = NEW.STATE;
   WK_POSTCODE = NEW.POST_CODE;
   WK_COUNTRY = NEW.COUNTRY;
   WK_PHONE = NEW.PHONE_NO;
   WK_FAX = NEW.FAX_NO;
   WK_MOBILE = NEW.MOBILE_NO;
   WK_EMAIL = NEW.EMAIL;
   WK_MAIL_ADDRESS_LINE1 = NEW.MAIL_ADDRESS1;
   WK_MAIL_ADDRESS_LINE2 = NEW.MAIL_ADDRESS2;
   WK_MAIL_CITY = NEW.MAIL_CITY;
   WK_MAIL_STATE = NEW.MAIL_STATE;
   WK_MAIL_POSTCODE = NEW.MAIL_POST_CODE;
   WK_MAIL_COUNTRY = NEW.MAIL_COUNTRY;
   WK_MAIL_PHONE = NEW.MAIL_PHONE;
   WK_CONTACT_FIRST_NAME = NEW.CONTACT_FIRST_NAME;
   WK_CONTACT_LAST_NAME = NEW.CONTACT_LAST_NAME;
   WK_CONTACT_ADDRESS_LINE1 = NEW.CONTACT_ADDRESS1;
   WK_CONTACT_ADDRESS_LINE2 = NEW.CONTACT_ADDRESS2;
   WK_CONTACT_CITY = NEW.CONTACT_CITY;
   WK_CONTACT_STATE = NEW.CONTACT_STATE;
   WK_CONTACT_POSTCODE = NEW.CONTACT_POST_CODE;
   WK_CONTACT_COUNTRY = NEW.CONTACT_COUNTRY;
   WK_CONTACT_PHONE = NEW.CONTACT_PHONE;
   WK_2ND_CONTACT_FIRST_NAME = NEW.SECOND_CONTACT_FIRST_NAME;
   WK_2ND_CONTACT_LAST_NAME = NEW.SECOND_CONTACT_LAST_NAME;
   WK_2ND_PHONE = NEW.SECOND_PHONE_NO;
   WK_2ND_MOBILE = NEW.SECOND_MOBILE_NO;
   WK_2ND_FAX = NEW.SECOND_FAX_NO;
   WK_2ND_EMAIL = NEW.SECOND_EMAIL;
   WK_CREATE_DATE = NEW.CREATE_DATE;
   WK_CREATE_DATE_STR = CAST(WK_CREATE_DATE AS CHAR(22));
   WK_CREATE_BY = NEW.CREATE_BY;

   SELECT EMPLOYEE_FTP_DIRECTORY FROM CONTROL INTO :WK_DIRECTORY;
   WK_FILENAME = WK_DIRECTORY || 'updperson.trn';
   WK_LABEL_LINE = WK_QUOTE || NONULL(WK_PERSON) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_STATUS) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_TITLE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_FIRST_NAME) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_LAST_NAME) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_TYPE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_ADDRESS_LINE1) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_ADDRESS_LINE2) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CITY) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_STATE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_POSTCODE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_COUNTRY) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_PHONE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_FAX) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MOBILE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_EMAIL) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_ADDRESS_LINE1) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_ADDRESS_LINE2) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_CITY) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_STATE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_POSTCODE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_COUNTRY) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_MAIL_PHONE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_FIRST_NAME) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_LAST_NAME) || WK_QUOTE || ',' ;

   WK_RESULT = FILE_WRITE(WK_FILENAME, WK_LABEL_LINE);
   IF (WK_RESULT <> 0) THEN
   BEGIN
      WK_FILENAME = WK_DIRECTORY || 'updperson.2rn';
      WK_RESULT = FILE_WRITE(WK_FILENAME, WK_LABEL_LINE);
   END

   WK_LABEL_LINE = WK_QUOTE || NONULL(WK_CONTACT_ADDRESS_LINE1) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_ADDRESS_LINE2) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_CITY) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_STATE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_POSTCODE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_COUNTRY) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CONTACT_PHONE) || WK_QUOTE || ',' ||

   WK_QUOTE || NONULL(WK_2ND_CONTACT_FIRST_NAME) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_2ND_CONTACT_LAST_NAME) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_2ND_PHONE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_2ND_MOBILE) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_2ND_FAX) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_2ND_EMAIL) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CREATE_DATE_STR) || WK_QUOTE || ',' ||
   WK_QUOTE || NONULL(WK_CREATE_BY) || WK_QUOTE  ;

   WK_FILENAME = WK_DIRECTORY || 'updperson.trn';
   WK_RESULT = FILE_WRITE(WK_FILENAME, WK_LABEL_LINE);
   IF (WK_RESULT <> 0) THEN
   BEGIN
      WK_FILENAME = WK_DIRECTORY || 'updperson.2rn';
      WK_RESULT = FILE_WRITE(WK_FILENAME, WK_LABEL_LINE);
   END

END^

