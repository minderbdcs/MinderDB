/*
add a detail table for the reports
with field prompts
related query id
for ranges 
then the too field is a differing query field
*/

CREATE TABLE REPORTS_DETAIL
(
  REPORT_ID             INTEGER NOT NULL,
  REPORT_DETAIL_ID      INTEGER NOT NULL,
  SEQUENCE              INTEGER,
  QUERY_FIELD           VARCHAR(30) ,
  QUERY_PROMPT          VARCHAR(80) ,
  QUERY_DB_FIELD        VARCHAR(80) ,
 PRIMARY KEY (REPORT_DETAIL_ID)
);


CREATE GENERATOR REPORT_DETAIL_ID_GEN;

CREATE INDEX REPORTS_DETAIL_ID_IDX ON REPORTS_DETAIL(REPORT_ID);

COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;
 
CREATE TRIGGER REPORTS_DETAIL_ID_INSERT FOR REPORTS_DETAIL
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
    IF (NEW.REPORT_DETAIL_ID IS NULL) THEN
        NEW.REPORT_DETAIL_ID = GEN_ID(REPORT_DETAIL_ID_GEN, 1);
END^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
