COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;
 

CREATE OR ALTER  TRIGGER SAVE_PURCHASE_ORDER FOR PURCHASE_ORDER
ACTIVE BEFORE DELETE POSITION 0 
AS
DECLARE VARIABLE WK_SAVE_PURCHASE_ITEM CHAR(1);
BEGIN
   BEGIN
      INSERT INTO PURCHASE_LINE_CANCEL(
        PURCHASE_ORDER ,
        PERSON_ID ,
        REQUISITION_NO ,
        PO_DATE ,
        PO_REVISION_NO ,
        COMPANY_ID ,
        DIVISION_ID ,
        PO_STATUS ,
        COMMENTS ,
        PO_PRINTED ,
        USER_ID ,
        ORDER_TYPE ,
        PO_LEGACY_DATE ,
        PO_CURRENCY ,
        PO_DUE_DATE ,
        PO_LEGACY_INTERNAL_ID ,
        PO_RECEIVE_WH_ID ,
        PO_LEGACY_MEMO ,
        PO_LEGACY_STATUS ,
        PO_LEGACY_RECVD_DATE ,
        PO_SHIP_TO_ADDRESS3 ,
        PO_SHIP_TO_ADDRESS4 ,
        PO_SHIP_TO_ADDRESS5 ,
        PO_CREATED_BY_NAME ,
        PO_RECEIVE_WH_NAME ,
        PO_LEGACY_STATUS_ID ,
        PO_SHIP_TO_ATTENSION ,
        PO_SHIP_TO_ADDRESSEE ,
        PO_SHIP_TO_PHONE ,
        PO_SHIP_TO_ADDRESS1 ,
        PO_SHIP_TO_ADDRESS2 ,
        PO_SHIP_TO_SUBURB ,
        PO_SHIP_TO_STATE ,
        PO_SHIP_TO_POSTCODE ,
        PO_SHIP_TO_COUNTRY ,
        PO_LEGACY_CONSIGNMENT ,
        PO_LEGACY_CREATED_BY_NAME ,
        PO_LEGACY_OWNER ,
        PO_LEGACY_OWNER_ID ,
        PO_LEGACY_RECV_ID ,
        PO_RECEIVER ,
        EARLIEST_DATE ,
        COST_CENTER ,
        PO_LEGACY_RECVD_QTY ,
        SUPPLIED_BY_ID ,
        SUPPLIER_CONTACT ,
        PO_SHIP_VIA ,
        PO_SHIP_VIA_SERVICE ,
        PO_SHIPPING_METHOD ,
        PO_FREIGHT_COST ,
        PO_CUSTOM_FEES ,
        PO_STORAGE_FEES ,
        PO_INSURANCE ,
        PO_AMOUNT_PAID ,
        PO_CONTAINER_FEES ,
        PO_UNLOADING_FEES ,
        PO_ADMIN_FEES ,
        PO_OTHER_FEES ,
        PO_TAX_AMOUNT ,
        PO_TAX_RATE ,
        PO_AMOUNT_DUE ,
        PO_LINE_EXTERNAL_NOTES ,
        REASON ,
        CANCEL_METHOD )
      VALUES (
        OLD.PURCHASE_ORDER ,
        OLD.PERSON_ID ,
        OLD.REQUISITION_NO ,
        OLD.PO_DATE ,
        OLD.PO_REVISION_NO ,
        OLD.COMPANY_ID ,
        OLD.DIVISION_ID ,
        OLD.PO_STATUS ,
        OLD.COMMENTS ,
        OLD.PO_PRINTED ,
        OLD.USER_ID ,
        OLD.ORDER_TYPE ,
        OLD.PO_LEGACY_DATE ,
        OLD.PO_CURRENCY ,
        OLD.PO_DUE_DATE ,
        OLD.PO_LEGACY_INTERNAL_ID ,
        OLD.PO_RECEIVE_WH_ID ,
        OLD.PO_LEGACY_MEMO ,
        OLD.PO_LEGACY_STATUS ,
        OLD.PO_LEGACY_RECVD_DATE ,
        OLD.PO_SHIP_TO_ADDRESS3 ,
        OLD.PO_SHIP_TO_ADDRESS4 ,
        OLD.PO_SHIP_TO_ADDRESS5 ,
        OLD.PO_CREATED_BY_NAME ,
        OLD.PO_RECEIVE_WH_NAME ,
        OLD.PO_LEGACY_STATUS_ID ,
        OLD.PO_SHIP_TO_ATTENSION ,
        OLD.PO_SHIP_TO_ADDRESSEE ,
        OLD.PO_SHIP_TO_PHONE ,
        OLD.PO_SHIP_TO_ADDRESS1 ,
        OLD.PO_SHIP_TO_ADDRESS2 ,
        OLD.PO_SHIP_TO_SUBURB ,
        OLD.PO_SHIP_TO_STATE ,
        OLD.PO_SHIP_TO_POSTCODE ,
        OLD.PO_SHIP_TO_COUNTRY ,
        OLD.PO_LEGACY_CONSIGNMENT ,
        OLD.PO_LEGACY_CREATED_BY_NAME ,
        OLD.PO_LEGACY_OWNER ,
        OLD.PO_LEGACY_OWNER_ID ,
        OLD.PO_LEGACY_RECV_ID ,
        OLD.PO_RECEIVER ,
        OLD.EARLIEST_DATE ,
        OLD.COST_CENTER ,
        OLD.PO_LEGACY_RECVD_QTY ,
        OLD.SUPPLIED_BY_ID ,
        OLD.SUPPLIER_CONTACT ,
        OLD.PO_SHIP_VIA ,
        OLD.PO_SHIP_VIA_SERVICE ,
        OLD.PO_SHIPPING_METHOD ,
        OLD.PO_FREIGHT_COST ,
        OLD.PO_CUSTOM_FEES ,
        OLD.PO_STORAGE_FEES ,
        OLD.PO_INSURANCE ,
        OLD.PO_AMOUNT_PAID ,
        OLD.PO_CONTAINER_FEES ,
        OLD.PO_UNLOADING_FEES ,
        OLD.PO_ADMIN_FEES ,
        OLD.PO_OTHER_FEES ,
        OLD.PO_TAX_AMOUNT ,
        OLD.PO_TAX_RATE ,
        OLD.PO_AMOUNT_DUE ,
        OLD.PO_LINE_EXTERNAL_NOTES ,
        'Purchase Order Record Deleted' ,
        'o' );
   END
END ^

CREATE OR ALTER  TRIGGER SAVE_PURCHASE_ORDER_LINE FOR PURCHASE_ORDER_LINE 
ACTIVE BEFORE DELETE POSITION 0 
AS
DECLARE VARIABLE WK_SAVE_PURCHASE_ITEM CHAR(1);
BEGIN
   BEGIN
      INSERT INTO PURCHASE_LINE_CANCEL(
        PURCHASE_ORDER ,
        PO_LINE ,
        REQUISITION_NO ,
        PROD_ID ,
        PO_LINE_QTY ,
        UNIT_PRICE ,
        UOM_ORDER ,
        PO_LINE_DUE_DATE ,
        PO_LINE_STATUS ,
        COMMENTS ,
        GST_VALUE ,
        GST_RATE ,
        GST_CODE ,
        ORIGINAL_QTY ,
        PO_LINE_DESCRIPTION ,
        PO_LINE_OPTIONS ,
        PO_LINE_QTY_F ,
        PO_LINE_LOTNO_LIST ,
        PO_LINE_STATUS_TF ,
        PO_LINE_CUSTOMER_ID ,
        PO_LINE_CUSTOMER_NAME ,
        PO_CURRENCY ,
        LAST_UPDATE_DATE ,
        PO_LEGACY_RECV_ID ,
        PO_REVISION_STATUS ,
        PO_LEGACY_LINE ,
        EARLIEST_DATE ,
        PO_LINE_EXTERNAL_NOTES ,
        PO_LINE_DISCOUNT ,
        PO_LINE_TOTAL ,
        LAST_UPDATE_BY ,
        REASON ,
        CANCEL_METHOD )
      VALUES (
        OLD.PURCHASE_ORDER ,
        OLD.PO_LINE ,
        OLD.REQUISITION_NO ,
        OLD.PROD_ID ,
        OLD.PO_LINE_QTY ,
        OLD.UNIT_PRICE ,
        OLD.UOM_ORDER ,
        OLD.PO_LINE_DUE_DATE ,
        OLD.PO_LINE_STATUS ,
        OLD.COMMENTS ,
        OLD.GST_VALUE ,
        OLD.GST_RATE ,
        OLD.GST_CODE ,
        OLD.ORIGINAL_QTY ,
        OLD.PO_LINE_DESCRIPTION ,
        OLD.PO_LINE_OPTIONS ,
        OLD.PO_LINE_QTY_F ,
        OLD.PO_LINE_LOTNO_LIST ,
        OLD.PO_LINE_STATUS_TF ,
        OLD.PO_LINE_CUSTOMER_ID ,
        OLD.PO_LINE_CUSTOMER_NAME ,
        OLD.PO_CURRENCY ,
        OLD.LAST_UPDATE_DATE ,
        OLD.PO_LEGACY_RECV_ID ,
        OLD.PO_REVISION_STATUS ,
        OLD.PO_LEGACY_LINE ,
        OLD.EARLIEST_DATE ,
        OLD.PO_LINE_EXTERNAL_NOTES ,
        OLD.PO_LINE_DISCOUNT ,
        OLD.PO_LINE_TOTAL ,
        OLD.LAST_UPDATE_BY ,
        'Purchase Order Line Record Deleted' ,
        'l' );
   END
END ^

CREATE OR ALTER  TRIGGER SAVE_PURCHASE_SUB_LINE FOR PURCHASE_SUB_LINE 
ACTIVE BEFORE DELETE POSITION 0 
AS
DECLARE VARIABLE WK_SAVE_PURCHASE_ITEM CHAR(1);
BEGIN
   BEGIN
      INSERT INTO PURCHASE_LINE_CANCEL(
        PURCHASE_ORDER ,
        PO_LINE ,
        SSN_ID ,
        PSL_OTHER1 ,
        PSL_OTHER2 ,
        PSL_OTHER_DATE3 ,
        PSL_OTHER_DATE4 ,
        PSL_STATUS ,
        USER_ID ,
        DEVICE_ID ,
        CREATE_DATE ,
        LAST_UPDATE_DATE ,
        LAST_UPDATE_BY ,
        PSL_ORDER_QTY ,
        PSL_RECEIVED_QTY ,
        REASON ,
        CANCEL_METHOD )
      VALUES (
        OLD.PURCHASE_ORDER ,
        OLD.PO_LINE ,
        OLD.SSN_ID ,
        OLD.PSL_OTHER1 ,
        OLD.PSL_OTHER2 ,
        OLD.PSL_OTHER_DATE3 ,
        OLD.PSL_OTHER_DATE4 ,
        OLD.PSL_STATUS ,
        OLD.USER_ID ,
        OLD.DEVICE_ID ,
        OLD.CREATE_DATE ,
        OLD.LAST_UPDATE_DATE ,
        OLD.LAST_UPDATE_BY ,
        OLD.PSL_ORDER_QTY ,
        OLD.PSL_RECEIVED_QTY ,
        'Purchase Sub Line Record Deleted' ,
        's' );
   END
END ^


SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
