COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;
 

ALTER PROCEDURE GET_SALE_ORDER_NO (ORDER_PREFIX CHAR(1) CHARACTER SET NONE)
RETURNS (SALE_ORDER_ID VARCHAR(10) CHARACTER SET NONE)
AS 
  

DECLARE VARIABLE iSaleNo INTEGER;
DECLARE VARIABLE iLengthSaleNo INTEGER;
DECLARE VARIABLE WK_MAX_LENGTH INTEGER;
DECLARE VARIABLE sSaleNo VARCHAR(10);
     
BEGIN
  iSaleNo = GEN_ID(SALE_ORDER_ID_GEN, 1) ;
  iLengthSaleNo = STRLEN(iSaleNo);
  
  /*
  sSaleNo = 'S'; /- Enter prefix number here -/
  */
  IF (ORDER_PREFIX IS NULL) THEN
  BEGIN
     sSaleNo = '';
  END
  ELSE
  BEGIN
     sSaleNo = ORDER_PREFIX; /* Enter prefix number here */
  END
  SELECT MAX_LENGTH FROM PARAM WHERE DATA_ID = 'SALESORDER' INTO :WK_MAX_LENGTH;
  WK_MAX_LENGTH = WK_MAX_LENGTH - STRLEN(sSaleNo);
  /* Padding leading with 0 */
  /* WHILE (iLengthSaleNo < 9) DO */
  WHILE (iLengthSaleNo < :WK_MAX_LENGTH) DO
  BEGIN
        sSaleNo = sSaleNo || '0';      
        iLengthSaleNo = iLengthSaleNo + 1;
  END
  sSaleNo = sSaleNo || iSaleNo;
  
  /* Return LoadNo to the caller */
  SALE_ORDER_ID = sSaleNo;
  SUSPEND;
  
  
END ^


SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
