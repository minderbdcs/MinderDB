COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */
/*
CREATE PROCEDURE RPT_ARCHIVE_DATA 
(
  THISWHID VARCHAR(2)
)
RETURNS
(
  WH_ID VARCHAR(2),
  LOCN_ID VARCHAR(10),
  PROD_ID VARCHAR(30),
  CURRENT_QTY VARCHAR(10),
  SHORT_DESC VARCHAR(50),
  MOVE_STAT VARCHAR(2),
  NAME VARCHAR(50)
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_BUSINESS_MONTHLY_1_DATA 
(
  THISCOMPANY VARCHAR(20),
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  PROD_ID VARCHAR(30),
  SSN_ID VARCHAR(20),
  SHORT_DESC VARCHAR(50),
  THISCOMPANY_ID VARCHAR(20),
  TRN_TYPE VARCHAR(4),
  TRN_CODE VARCHAR(1),
  CURRENT_QTY INTEGER
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_BUSINESS_MONTHLY_2_DATA 
(
  THISCOMPANY VARCHAR(20),
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  WH_ID1 VARCHAR(30),
  LOCN_ID1 VARCHAR(30),
  WH_ID2 VARCHAR(30),
  LOCN_ID2 VARCHAR(30),
  PROD_ID VARCHAR(30),
  DESCRIPTION VARCHAR(50),
  QTY INTEGER
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_BUSINESS_MONTHLY_3_DATA 
(
  THISCOMPANY VARCHAR(20),
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  PICK_ORDER VARCHAR(30),
  THISPICKORDER VARCHAR(30),
  PROD_ID VARCHAR(30),
  SHORT_DESC VARCHAR(50),
  QTY VARCHAR(30),
  COMPANY_ID VARCHAR(30),
  TRN_DATE TIMESTAMP
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_CANCELLED_DATA 
(
  THISPICK_ORDER VARCHAR(50)
)
RETURNS
(
  PICK_ORDER VARCHAR(50),
  SHORT_DESC VARCHAR(50),
  PROD_ID VARCHAR(50),
  PICK_LABEL_NO VARCHAR(50)
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_DAILY_1_A_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  THISCOUNT INTEGER
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_DAILY_1_B_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  THISCOUNT INTEGER
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_DAILY_2_A_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  QTYTOTAL INTEGER,
  PROD_ID VARCHAR(50),
  SHORT_DESC VARCHAR(50)
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_DAILY_2_B_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  QTYTOTAL INTEGER,
  PROD_ID VARCHAR(50),
  SHORT_DESC VARCHAR(50)
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_DAILY_3_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  THISCOUNT INTEGER
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_DAILY_4_A_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  QTYTOTAL INTEGER,
  PROD_ID VARCHAR(50),
  SHORT_DESC VARCHAR(50)
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_DAILY_4_B_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  QTYTOTAL INTEGER,
  PROD_ID VARCHAR(50),
  SHORT_DESC VARCHAR(50)
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_DAILY_4_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  THISCOUNT INTEGER
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_DAILY_5_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  THISCOUNT INTEGER
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_DAILY_6_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  THISCOUNT INTEGER
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_PRODUCT_LEVELS_DATA 
(
  THISWHID VARCHAR(4)
)
RETURNS
(
  LOCN_ID VARCHAR(50),
  PROD_ID VARCHAR(50),
  CURRENT_QTY INTEGER,
  SHORT_DES VARCHAR(50),
  THISSTATUS VARCHAR(40)
)
AS
BEGIN EXIT; END ^
CREATE PROCEDURE RPT_PRODUCT_RECEIPT_DATA 
(
  THISPROD_ID VARCHAR(30),
  THISMODE INTEGER,
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  PROD VARCHAR(30),
  QTY INTEGER,
  TRN_DATE TIMESTAMP,
  THISGRN VARCHAR(30),
  LOCN_ID VARCHAR(30),
  SHORT_DESC VARCHAR(50)
)
AS
BEGIN EXIT; END ^
*/

ALTER PROCEDURE RPT_ARCHIVE_DATA 
(
  THISWHID VARCHAR(2)
)
RETURNS
(
  WH_ID VARCHAR(2),
  LOCN_ID VARCHAR(10),
  PROD_ID VARCHAR(30),
  CURRENT_QTY VARCHAR(10),
  SHORT_DESC VARCHAR(50),
  MOVE_STAT VARCHAR(2),
  NAME VARCHAR(50)
)
AS
BEGIN

      FOR SELECT ISSN.WH_ID, ISSN.LOCN_ID,ISSN.PROD_ID,ISSN.CURRENT_QTY,PROD_PROFILE.SHORT_DESC, LOCATION.MOVE_STAT , COMPANY.NAME
          FROM ISSN
          LEFT OUTER JOIN PROD_PROFILE ON ISSN.PROD_ID = PROD_PROFILE.PROD_ID
          LEFT OUTER JOIN LOCATION ON ISSN.WH_ID = LOCATION.WH_ID AND ISSN.LOCN_ID = LOCATION.LOCN_ID
          LEFT OUTER JOIN COMPANY ON ISSN.COMPANY_ID = COMPANY.COMPANY_ID
          WHERE (ISSN.WH_ID = :THISWHID ) AND
                ((LOCATION.MOVE_STAT = 'AR') OR
                 (ISSN.ISSN_STATUS = 'AR')) 
          ORDER BY ISSN.LOCN_ID, ISSN.PROD_ID

      INTO
      :WH_ID,
    :LOCN_ID,
    :PROD_ID,
    :CURRENT_QTY,
    :SHORT_DESC,
    :MOVE_STAT,
    :NAME

      DO
      BEGIN
         SUSPEND;
      END

END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_BUSINESS_MONTHLY_1_DATA 
(
  THISCOMPANY VARCHAR(20),
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  PROD_ID VARCHAR(30),
  SHORT_DESC VARCHAR(50),
  THISCOMPANY_ID VARCHAR(20),
  CURRENT_QTY INTEGER
 /* 
  SSN_ID VARCHAR(20),
  TRN_TYPE VARCHAR(4),
  TRN_CODE VARCHAR(1)
 */  
)
AS
BEGIN
  /* PROCEDURE BODY */
  FOR
SELECT ISSN.PROD_ID, PROD_PROFILE.SHORT_DESC,PROD_PROFILE.COMPANY_ID , SUM(ISSN.ORIGINAL_QTY)
FROM GRN
JOIN SSN ON SSN.GRN = GRN.GRN
JOIN ISSN ON ISSN.SSN_ID = SSN.SSN_ID
JOIN PROD_PROFILE ON PROD_PROFILE.PROD_ID = ISSN.PROD_ID
WHERE (GRN.GRN_DATE BETWEEN ZEROTIME(:THISSTART) AND MAXTIME(:THISEND)) AND
   PROD_PROFILE.COMPANY_ID = :THISCOMPANY 
GROUP BY PROD_PROFILE.COMPANY_ID, ISSN.PROD_ID, PROD_PROFILE.SHORT_DESC
/*
FROM ISSN
INNER JOIN  TRANSACTIONS_ARCHIVE ON ISSN.SSN_ID = TRANSACTIONS_ARCHIVE.OBJECT
INNER JOIN  PROD_PROFILE ON ISSN.PROD_ID = PROD_PROFILE.PROD_ID
WHERE TRN_TYPE = 'TRIL' AND TRN_CODE = 'W' AND 
   (TRANSACTIONS_ARCHIVE.TRN_DATE BETWEEN ZEROTIME(:THISSTART) AND MAXTIME(:THISEND)) AND
   PROD_PROFILE.COMPANY_ID = :THISCOMPANY 
ORDER BY PROD_PROFILE.COMPANY_ID, PROD_PROFILE.PROD_ID
*/

  INTO
          :PROD_ID,
          :SHORT_DESC,
          :THISCOMPANY_ID,
          :CURRENT_QTY
  DO
  BEGIN
  SUSPEND;
  END
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_BUSINESS_MONTHLY_2_DATA 
(
  THISCOMPANY VARCHAR(20),
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  WH_ID1 VARCHAR(30),
  LOCN_ID1 VARCHAR(30),
  WH_ID2 VARCHAR(30),
  LOCN_ID2 VARCHAR(30),
  PROD_ID VARCHAR(30),
  DESCRIPTION VARCHAR(50),
  QTY INTEGER
)
AS
BEGIN
  /* PROCEDURE BODY */
  QTY = 0;
/*
  FOR
    SELECT SSN_HIST.WH_ID AS WH_ID1,SSN_HIST.LOCN_ID AS LOCN_ID1,
       SSN_HIST.WH_ID AS WH_ID2,SSN_HIST.LOCN_ID AS LOCN_ID2,ISSN.PROD_ID,
       SSN_HIST.SSN_ID AS DESCRIPTION, ISSN.CURRENT_QTY AS QTY
    FROM SSN_HIST
    LEFT OUTER JOIN  SSN ON SSN_HIST.SSN_ID = SSN.SSN_ID
    LEFT OUTER JOIN  ISSN ON SSN_HIST.SSN_ID = ISSN.SSN_ID
    WHERE TRN_TYPE = 'TRLI' AND SSN.COMPANY_ID = :THISCOMPANY
    AND  (TRN_DATE >= :THISSTART AND TRN_DATE <= :THISEND )

  INTO
:WH_ID1,
:LOCN_ID1,
:WH_ID2,
:LOCN_ID2,
:PROD_ID,
:DESCRIPTION,
:QTY
 
  DO
  BEGIN
  SUSPEND;
  END
*/
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_BUSINESS_MONTHLY_3_DATA 
(
  THISCOMPANY VARCHAR(20),
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  PROD_ID VARCHAR(30),
  SHORT_DESC VARCHAR(50),
  QTY VARCHAR(30),
  COMPANY_ID VARCHAR(30)
)
AS
BEGIN
  /* PROCEDURE BODY */
  FOR
 SELECT PROD_PROFILE.PROD_ID, PROD_PROFILE.SHORT_DESC, SUM(ISSN.PREV_QTY), PROD_PROFILE.COMPANY_ID 
FROM ISSN
   INNER JOIN PROD_PROFILE ON ISSN.PROD_ID = PROD_PROFILE.PROD_ID
   WHERE PROD_PROFILE.COMPANY_ID = :THISCOMPANY
   AND (ISSN.DESPATCHED_DATE BETWEEN ZEROTIME(:THISSTART) AND MAXTIME(:THISEND))
   GROUP BY PROD_PROFILE.COMPANY_ID, PROD_PROFILE.PROD_ID,PROD_PROFILE.SHORT_DESC
  INTO
:PROD_ID,
:SHORT_DESC,
:QTY,
:COMPANY_ID
  DO
  BEGIN
  SUSPEND;
  END
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_CANCELLED_DATA 
(
  THISPICK_ORDER VARCHAR(50)
)
RETURNS
(
  PICK_ORDER VARCHAR(50),
  SHORT_DESC VARCHAR(50),
  PROD_ID VARCHAR(50),
  PICK_LABEL_NO VARCHAR(50)
)
AS
BEGIN
  /* PROCEDURE BODY */
  FOR
 SELECT PICK_ITEM.PICK_ORDER, PROD_PROFILE.SHORT_DESC, PICK_ITEM.PROD_ID, PICK_ITEM.PICK_LABEL_NO
FROM PICK_ITEM
 INNER JOIN PICK_ITEM_DETAIL ON PICK_ITEM.PICK_LABEL_NO = PICK_ITEM_DETAIL.PICK_LABEL_NO
 LEFT OUTER JOIN PROD_PROFILE ON PROD_PROFILE.PROD_ID = PICK_ITEM.PROD_ID
 WHERE PICK_DETAIL_STATUS = 'XX' AND PICK_ITEM.PICK_ORDER = :THISPICK_ORDER
ORDER BY PICK_ITEM.PROD_ID

  INTO
:PICK_ORDER,
:SHORT_DESC ,
:PROD_ID,
:PICK_LABEL_NO 

  DO
  BEGIN
  SUSPEND;
  END
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_DAILY_1_A_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  THISCOUNT INTEGER
)
AS
BEGIN
  /* PROCEDURE BODY */
  SELECT COUNT(DISTINCT REFERENCE) FROM TRANSACTIONS_ARCHIVE
  WHERE   TRN_TYPE = 'DSDX'
   AND (TRN_DATE BETWEEN ZEROTIME(:THISSTART) AND MAXTIME(:THISEND))
   AND COMPLETE IS NULL
  INTO
  :THISCOUNT;
  SUSPEND;
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_DAILY_1_B_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  THISCOUNT INTEGER
)
AS
BEGIN
  /* PROCEDURE BODY */
  FOR SELECT COUNT(*) FROM PICK_ORDER
  WHERE   PICK_STATUS = 'CN'
   AND (ORDER_CANCELLED BETWEEN ZEROTIME(:THISSTART) AND MAXTIME(:THISEND))
  INTO
  :THISCOUNT
  DO
  BEGIN
  SUSPEND;
  END
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_DAILY_2_A_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  QTYTOTAL INTEGER,
  PROD_ID VARCHAR(50),
  SHORT_DESC VARCHAR(50)
)
AS
BEGIN
  /* PROCEDURE BODY */
  FOR

/*
 SELECT COUNT(*) AS QTYTOTAL,PICK_ITEM.PROD_ID,PROD_PROFILE.SHORT_DESC  FROM TRANSACTIONS_ARCHIVE
LEFT OUTER  JOIN PICK_ITEM ON TRANSACTIONS_ARCHIVE.OBJECT = PICK_ITEM.PICK_ORDER
LEFT OUTER  JOIN PROD_PROFILE ON PICK_ITEM.PROD_ID = PROD_PROFILE.PROD_ID
WHERE TRN_TYPE = 'PKAL'
   AND (TRN_DATE BETWEEN ZEROTIME(:THISSTART) AND MAXTIME(:THISEND))
GROUP BY PICK_ITEM.PROD_ID,PROD_PROFILE.SHORT_DESC
*/
 SELECT COUNT(ISSN.PREV_QTY), ISSN.PROD_ID, PROD_PROFILE.SHORT_DESC
 FROM ISSN
 LEFT OUTER  JOIN PROD_PROFILE ON ISSN.PROD_ID = PROD_PROFILE.PROD_ID
 WHERE (ISSN.DESPATCHED_DATE BETWEEN ZEROTIME(:THISSTART) AND MAXTIME(:THISEND))
 GROUP BY ISSN.PROD_ID,PROD_PROFILE.SHORT_DESC

  INTO
  :QTYTOTAL,
  :PROD_ID,
  :SHORT_DESC
  DO
  BEGIN
  SUSPEND;
  END
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_DAILY_2_B_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  QTYTOTAL INTEGER,
  PROD_ID VARCHAR(50),
  SHORT_DESC VARCHAR(50)
)
AS
BEGIN
  /* PROCEDURE BODY */
  FOR
/*
 SELECT COUNT(*) AS QTYTOTAL,PICK_ITEM.PROD_ID,PROD_PROFILE.SHORT_DESC  FROM TRANSACTIONS_ARCHIVE
LEFT OUTER  JOIN PICK_ITEM ON TRANSACTIONS_ARCHIVE.OBJECT = PICK_ITEM.PICK_ORDER
LEFT OUTER  JOIN PROD_PROFILE ON PICK_ITEM.PROD_ID = PROD_PROFILE.PROD_ID
WHERE TRN_TYPE = 'PKAL'
GROUP BY PICK_ITEM.PROD_ID,PROD_PROFILE.SHORT_DESC
*/
 SELECT SUM(PICK_ITEM_CANCEL.PICK_ORDER_QTY), PICK_ITEM_CANCEL.PROD_ID, PROD_PROFILE.SHORT_DESC
 FROM PICK_ITEM_CANCEL
 LEFT OUTER  JOIN PROD_PROFILE ON PICK_ITEM_CANCEL.PROD_ID = PROD_PROFILE.PROD_ID
 WHERE (PICK_ITEM_CANCEL.LAST_UPDATE_DATE BETWEEN ZEROTIME(:THISSTART) AND MAXTIME(:THISEND))
 GROUP BY PICK_ITEM_CANCEL.PROD_ID,PROD_PROFILE.SHORT_DESC
  INTO
  :QTYTOTAL,
  :PROD_ID,
  :SHORT_DESC
  DO
  BEGIN
  SUSPEND;
  END
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_DAILY_3_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  THISCOUNT INTEGER
)
AS
BEGIN
  /* PROCEDURE BODY */
  /* pick was started after the too date */
  THISCOUNT = 0;
  SELECT COUNT(DISTINCT PICK_ITEM.PICK_ORDER) FROM PICK_ITEM
  WHERE   ((PICK_ITEM.PICK_STARTED > MAXTIME(:THISEND))
  OR (PICK_ITEM.PICK_STARTED IS NULL))
  AND (PICK_ITEM.CREATE_DATE <= MAXTIME(:THISEND))
  INTO
  :THISCOUNT;
  SUSPEND;
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_DAILY_4_A_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  QTYTOTAL INTEGER,
  PROD_ID VARCHAR(50),
  SHORT_DESC VARCHAR(50)
)
AS
BEGIN
  /* PROCEDURE BODY */
/*
 SELECT COUNT(*) AS QTYTOTAL,PICK_ITEM.PROD_ID,PROD_PROFILE.SHORT_DESC  FROM TRANSACTIONS_ARCHIVE
LEFT OUTER  JOIN PICK_ITEM ON TRANSACTIONS_ARCHIVE.OBJECT = PICK_ITEM.PICK_ORDER
LEFT OUTER  JOIN PROD_PROFILE ON PICK_ITEM.PROD_ID = PROD_PROFILE.PROD_ID
WHERE TRN_TYPE = 'PKAL'
GROUP BY PICK_ITEM.PROD_ID,PROD_PROFILE.SHORT_DESC
*/
  FOR
  SELECT SUM(PICK_ITEM.PICK_ORDER_QTY), PICK_ITEM.PROD_ID ,PROD_PROFILE.SHORT_DESC  
  FROM PICK_ITEM
  LEFT OUTER  JOIN PROD_PROFILE ON PICK_ITEM.PROD_ID = PROD_PROFILE.PROD_ID
  WHERE   ((PICK_ITEM.PICK_STARTED > MAXTIME(:THISEND))
  OR (PICK_ITEM.PICK_STARTED IS NULL))
  AND (PICK_ITEM.CREATE_DATE <= MAXTIME(:THISEND))
  GROUP BY PICK_ITEM.PROD_ID,PROD_PROFILE.SHORT_DESC

  INTO
  :QTYTOTAL,
  :PROD_ID,
  :SHORT_DESC
  DO
  BEGIN
  SUSPEND;
  END
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_DAILY_4_B_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  QTYTOTAL INTEGER,
  PROD_ID VARCHAR(50),
  SHORT_DESC VARCHAR(50)
)
AS
BEGIN
  /* PROCEDURE BODY */
/*
  FOR
 SELECT COUNT(*) AS QTYTOTAL,PICK_ITEM.PROD_ID,PROD_PROFILE.SHORT_DESC  FROM TRANSACTIONS_ARCHIVE
LEFT OUTER  JOIN PICK_ITEM ON TRANSACTIONS_ARCHIVE.OBJECT = PICK_ITEM.PICK_ORDER
LEFT OUTER  JOIN PROD_PROFILE ON PICK_ITEM.PROD_ID = PROD_PROFILE.PROD_ID
WHERE TRN_TYPE = 'PKAL'
GROUP BY PICK_ITEM.PROD_ID,PROD_PROFILE.SHORT_DESC

  INTO
  :QTYTOTAL,
  :PROD_ID,
  :SHORT_DESC
  DO
  BEGIN
  SUSPEND;
  END
*/
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_DAILY_4_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  THISCOUNT INTEGER
)
AS
BEGIN
  /* PROCEDURE BODY */
/*
  FOR SELECT COUNT(*) AS THISCOUNT  FROM TRANSACTIONS_ARCHIVE
  WHERE   TRN_TYPE = 'PKAL' AND (TRN_DATE >= :THISSTART AND TRN_DATE <= :THISEND)
  INTO
  :THISCOUNT
  DO
  BEGIN
  SUSPEND;
  END
*/
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_DAILY_5_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  THISCOUNT INTEGER
)
AS
BEGIN
  /* PROCEDURE BODY */
SELECT  COUNT(DISTINCT(PICK_ITEM.PICK_ORDER))
FROM PICK_ITEM 
WHERE PICK_ITEM.PICK_LINE_STATUS = 'PL' 
AND (PICK_ITEM.DESPATCH_LOCATION IS NOT NULL)
AND ('TODAY' = ZEROTIME(:THISSTART) )
  INTO
  :THISCOUNT;
  SUSPEND;
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_DAILY_6_DATA 
(
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  THISCOUNT INTEGER
)
AS
BEGIN
  /* PROCEDURE BODY */
  FOR
SELECT  COUNT(DISTINCT(PICK_ITEM.PICK_ORDER))
FROM PICK_ORDER
INNER JOIN PICK_ITEM ON PICK_ORDER.PICK_ORDER = PICK_ITEM.PICK_ORDER
INNER JOIN SYS_USER ON PICK_ITEM.USER_ID = SYS_USER.USER_ID
WHERE (PICK_ORDER.ASSEMBLY_STARTED BETWEEN ZEROTIME(:THISSTART) AND MAXTIME(:THISEND))
  INTO
  :THISCOUNT
  DO
  BEGIN
  SUSPEND;
  END
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_PRODUCT_LEVELS_DATA 
(
  THISWHID VARCHAR(4)
)
RETURNS
(
  LOCN_ID VARCHAR(50),
  PROD_ID VARCHAR(50),
  CURRENT_QTY INTEGER,
  SHORT_DES VARCHAR(50),
  THISSTATUS VARCHAR(40)
)
AS
BEGIN
  /* PROCEDURE BODY */
  FOR
   SELECT ISSN.LOCN_ID,ISSN.PROD_ID,ISSN.CURRENT_QTY,PROD_PROFILE.SHORT_DESC, ISSN.ISSN_STATUS 

   FROM ISSN
   LEFT OUTER JOIN PROD_PROFILE ON ISSN.PROD_ID = PROD_PROFILE.PROD_ID
   WHERE ISSN.WH_ID = :THISWHID
   ORDER BY ISSN.LOCN_ID, ISSN.PROD_ID

  INTO
  :LOCN_ID,
  :PROD_ID,
  :CURRENT_QTY,
  :SHORT_DES,
  :THISSTATUS
  DO
  BEGIN
  SUSPEND;
  END
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

/* STORED PROCEDURES */



ALTER PROCEDURE RPT_PRODUCT_RECEIPT_DATA 
(
  THISPROD_ID VARCHAR(30),
  THISMODE INTEGER,
  THISSTART TIMESTAMP,
  THISEND TIMESTAMP
)
RETURNS
(
  PROD VARCHAR(30),
  QTY INTEGER,
  TRN_DATE TIMESTAMP,
  THISGRN VARCHAR(30),
  LOCN_ID VARCHAR(30),
  SHORT_DESC VARCHAR(50)
)
AS
BEGIN
  /* PROCEDURE BODY */
   IF (THISMODE = 0) THEN
   BEGIN
      FOR
      SELECT TRANSACTIONS_ARCHIVE.OBJECT , TRANSACTIONS_ARCHIVE.QTY, TRANSACTIONS_ARCHIVE.TRN_DATE, TRANSACTIONS_ARCHIVE.SUB_LOCN_ID , TRANSACTIONS_ARCHIVE.LOCN_ID,PROD_PROFILE.SHORT_DESC
      FROM TRANSACTIONS_ARCHIVE
      LEFT OUTER JOIN PROD_PROFILE ON TRANSACTIONS_ARCHIVE.OBJECT = PROD_PROFILE.PROD_ID
      WHERE TRANSACTIONS_ARCHIVE.TRN_TYPE = 'GRNV' AND 
         TRANSACTIONS_ARCHIVE.TRN_CODE IN  ('P','Q') AND 
         TRANSACTIONS_ARCHIVE.OBJECT = :THISPROD_ID AND
         (TRANSACTIONS_ARCHIVE.TRN_DATE BETWEEN ZEROTIME(:THISSTART) AND MAXTIME(:THISEND))
       ORDER BY TRANSACTIONS_ARCHIVE.OBJECT, TRANSACTIONS_ARCHIVE.TRN_DATE
      INTO
      :PROD,
      :QTY,
      :TRN_DATE,
      :THISGRN,
      :LOCN_ID,
      :SHORT_DESC
      DO
      BEGIN
         SUSPEND;
      END
   END
   IF (THISMODE = 1) THEN
   BEGIN
      FOR
      SELECT TRANSACTIONS_ARCHIVE.OBJECT , TRANSACTIONS_ARCHIVE.QTY, TRANSACTIONS_ARCHIVE.TRN_DATE, TRANSACTIONS_ARCHIVE.SUB_LOCN_ID , TRANSACTIONS_ARCHIVE.LOCN_ID,PROD_PROFILE.SHORT_DESC
      FROM TRANSACTIONS_ARCHIVE
      LEFT OUTER JOIN PROD_PROFILE ON TRANSACTIONS_ARCHIVE.OBJECT = PROD_PROFILE.PROD_ID
      WHERE TRANSACTIONS_ARCHIVE.TRN_TYPE = 'GRNV' AND 
         TRANSACTIONS_ARCHIVE.TRN_CODE IN  ('P','Q') AND 
         TRANSACTIONS_ARCHIVE.OBJECT = :THISPROD_ID AND
         (TRANSACTIONS_ARCHIVE.TRN_DATE BETWEEN ZEROTIME(:THISSTART) AND MAXTIME(:THISEND))
       ORDER BY TRANSACTIONS_ARCHIVE.SUB_LOCN_ID, TRANSACTIONS_ARCHIVE.OBJECT
      INTO
      :PROD,
      :QTY,
      :TRN_DATE,
      :THISGRN,
      :LOCN_ID,
      :SHORT_DESC
      DO
      BEGIN
         SUSPEND;
      END
   END
END
 ^

SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;
