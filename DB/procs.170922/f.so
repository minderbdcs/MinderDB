CREATE GENERATOR PICK_ORDER_DX_ID;

ALTER TABLE PICK_ORDER_DX ADD PA_RECORD_ID RECORD_ID NOT NULL;
/* ALTER TABLE PICK_ORDER_DX ADD LAST_UPDATE_DATE LAST_UPDATE_DATE; */


COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;

CREATE OR ALTER TRIGGER ADD_PICK_ORDER_DX FOR PICK_ORDER_DX 
ACTIVE BEFORE INSERT POSITION 10 
AS
BEGIN
  IF (NEW.PA_RECORD_ID IS NULL) THEN
      NEW.PA_RECORD_ID = GEN_ID(PICK_ORDER_DX_ID, 1);
  IF (NEW.PA_RECORD_ID = 0) THEN
      NEW.PA_RECORD_ID = GEN_ID(PICK_ORDER_DX_ID, 1);
END ^

CREATE TRIGGER MOD_PICK_ORDER_DX FOR PICK_ORDER_DX 
ACTIVE BEFORE UPDATE POSITION 10 
AS
BEGIN
  IF (NEW.PA_RECORD_ID IS NULL) THEN
      NEW.PA_RECORD_ID = GEN_ID(PICK_ORDER_DX_ID, 1);
  IF (NEW.PA_RECORD_ID = 0) THEN
      NEW.PA_RECORD_ID = GEN_ID(PICK_ORDER_DX_ID, 1);
END ^



SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;

update PICK_ORDER_DX set last_update_date = 'NOW';
commit;


alter table PICK_ORDER_DX  ADD CONSTRAINT PICK_ORDER_DX_PKEY PRIMARY KEY ( PA_RECORD_ID);

commit;
/* alter table PICK_ORDER_DX drop last_update_date; */
