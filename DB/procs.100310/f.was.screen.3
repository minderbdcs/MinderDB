COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;
 
DROP   TRIGGER UPD_SYS_SCREEN_TAB ^
COMMIT^

CREATE TRIGGER UPD_SYS_SCREEN_TAB FOR SYS_SCREEN_TAB 
ACTIVE BEFORE UPDATE POSITION 10 
AS
BEGIN
   IF ((NEW.RECORD_ID IS NULL) OR (NEW.RECORD_ID = 0)) THEN
   BEGIN
      NEW.RECORD_ID  = GEN_ID(SYS_SCREEN_TAB_ID_GEN,1);
   END
   NEW.LAST_UPDATE_DATE = 'NOW';
END ^


SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;

CREATE TABLE SYS_SCREEN_BUTTON (RECORD_ID INTEGER NOT NULL,
        SSB_BUTTON_NAME CODE,
        SSB_SEQUENCE SEQUENCE_NO,
        SSB_TITLE CODE,
        SSB_NOTES NOTES,
        SSB_ACTIVE_COLOUR CODE ,
        SSB_INACTIVE_COLOUR CODE ,
        SSB_TAB_STATUS STATUS,
        SS_NAME CODE NOT NULL,
        SSV_NAME DESCR,
        SSB_ACTION NOTES,
        SSB_IMAGE IMAGE,
        SSB_USER_TYPE CODE,
        SSB_DEVICE_TYPE DEVICE_TYPE,
        WH_ID WH_ID ,
        COMPANY_ID COMPANY ,
        LAST_UPDATE_DATE LAST_UPDATE_DATE,
        LAST_UPDATE_BY USER_ID,
PRIMARY KEY (RECORD_ID));

ALTER TABLE SYS_SCREEN_VAR ADD SSV_BUTTON CODE;
ALTER TABLE SYS_SCREEN_VAR ADD SSV_ACTION NOTES;

CREATE GENERATOR SYS_SCREEN_BUTTON_ID_GEN;
CREATE INDEX SYS_SCREEN_BUTTON_NAME_IDX ON SYS_SCREEN_BUTTON (SSB_BUTTON_NAME);
CREATE INDEX SYS_SCREEN_BUTTON_SSNAME_IDX ON SYS_SCREEN_BUTTON (SS_NAME);

COMMIT WORK;
SET AUTODDL OFF;
SET TERM ^ ;
 
CREATE TRIGGER ADD_SYS_SCREEN_BUTTON FOR SYS_SCREEN_BUTTON 
ACTIVE BEFORE INSERT POSITION 10 
AS
BEGIN
   IF ((NEW.RECORD_ID IS NULL) OR (NEW.RECORD_ID = 0)) THEN
   BEGIN
      NEW.RECORD_ID  = GEN_ID(SYS_SCREEN_BUTTON_ID_GEN,1);
   END
   NEW.LAST_UPDATE_DATE = 'NOW';
END ^

CREATE TRIGGER UPD_SYS_SCREEN_BUTTON FOR SYS_SCREEN_BUTTON
ACTIVE BEFORE UPDATE POSITION 10 
AS
BEGIN
   IF ((NEW.RECORD_ID IS NULL) OR (NEW.RECORD_ID = 0)) THEN
   BEGIN
      NEW.RECORD_ID  = GEN_ID(SYS_SCREEN_BUTTON_ID_GEN,1);
   END
   NEW.LAST_UPDATE_DATE = 'NOW';
END ^


SET TERM ; ^
COMMIT WORK;
SET AUTODDL ON;

